---
import { contentfulClient } from "../lib/contentful"
import type { Photo, PropertyType } from "../lib/types"
import Property from "./Property.astro"

const entries = await contentfulClient.getEntries<PropertyType>({
	content_type: "property",
})

const properties = entries.items.map((entry) => entry.fields)
---

<article class="mx-auto grid max-w-7xl grid-cols-2 gap-4 p-4 md:grid-cols-3 lg:grid-cols-3">
	{
		properties.map((property) => {
			const photos = property.photos
				? (property.photos as Photo[]).map((photo) => photo.fields.file.url)
				: ([] as Photo[])

			return (
				<Property
					key={property.id}
					id={property.id}
					photos={photos}
					title={property.title}
					precio={property.precio}
					habitaciones={property.habitaciones}
					m2={property.m2}
				/>
			)
		})
	}
</article>
